{
  "id": "/questions/2068482",
  "creationDate": "2014-01-17T16:06:13.083",
  "body": "\n\nI was given this WPF application, when I tried to run the program in Debug mode it would crash before getting to Windows1.xml. I later tried running in Release Mode and it would run successfully. I narrowed it down to that, I needed to turn on \"Optimize Code\" for it to work.\n\n**Note: Breakpoints, stepping into from debug, and stopping on throw exceptions don't work.**\n\n**Edit:** The exception was WPF (very popular & not helpful) generic exception:\n\n*{\"Cannot create instance of 'Main' defined in assembly 'VCell2, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null'. Exception has been thrown by the target of an invocation.  Error in markup file 'Window1.xaml' Line 1 Position 9.\"}* \n  Source=\"PresentationFramework\"\n  LineNumber=1\n  LinePosition=9\n\n**Edit:** The inner - inner exception:\n{\"The specified module could not be found. (Exception from HRESULT: 0x8007007E)\":null}\n\nHere was the stack trace I was getting:\n\n\t   at System.Windows.Markup.XamlParseException.ThrowException(String message, Exception innerException, Int32 lineNumber, Int32 linePosition, Uri baseUri, XamlObjectIds currentXamlObjectIds, XamlObjectIds contextXamlObjectIds, Type objectType)\n\t   at System.Windows.Markup.XamlParseException.ThrowException(ParserContext parserContext, Int32 lineNumber, Int32 linePosition, String message, Exception innerException)\n\t   at System.Windows.Markup.BamlRecordReader.ThrowExceptionWithLine(String message, Exception innerException)\n\t   at System.Windows.Markup.BamlRecordReader.CreateInstanceFromType(Type type, Int16 typeId, Boolean throwOnFail)\n\t   at System.Windows.Markup.BamlRecordReader.GetElementAndFlags(BamlElementStartRecord bamlElementStartRecord, Object& element, ReaderFlags& flags, Type& delayCreatedType, Int16& delayCreatedTypeId)\n\t   at System.Windows.Markup.BamlRecordReader.BaseReadElementStartRecord(BamlElementStartRecord bamlElementRecord)\n\t   at System.Windows.Markup.BamlRecordReader.ReadElementStartRecord(BamlElementStartRecord bamlElementRecord)\n\t   at System.Windows.Markup.BamlRecordReader.ReadRecord(BamlRecord bamlRecord)\n\t   at System.Windows.Markup.BamlRecordReader.Read(Boolean singleRecord)\n\t   at System.Windows.Markup.TreeBuilderBamlTranslator.ParseFragment()\n\t   at System.Windows.Markup.TreeBuilder.Parse()\n\t   at System.Windows.Markup.XamlReader.LoadBaml(Stream stream, ParserContext parserContext, Object parent, Boolean closeStream)\n\t   at System.Windows.Application.LoadBamlStreamWithSyncInfo(Stream stream, ParserContext pc)\n\t   at System.Windows.Application.LoadComponent(Uri resourceLocator, Boolean bSkipJournaledProperties)\n\t   at System.Windows.Application.DoStartup()\n\t   at System.Windows.Application.<.ctor>b__0(Object unused)\n\t   at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Boolean isSingleParameter)\n\t   at System.Windows.Threading.ExceptionWrapper.TryCatchWhen(Object source, Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)\n\t   at System.Windows.Threading.Dispatcher.WrappedInvoke(Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)\n\t   at System.Windows.Threading.DispatcherOperation.InvokeImpl()\n\t   at System.Windows.Threading.DispatcherOperation.InvokeInSecurityContext(Object state)\n\t   at System.Threading.ExecutionContext.runTryCode(Object userData)\n\t   at System.Runtime.CompilerServices.RuntimeHelpers.ExecuteCodeWithGuaranteedCleanup(TryCode code, CleanupCode backoutCode, Object userData)\n\t   at System.Threading.ExecutionContext.RunInternal(ExecutionContext executionContext, ContextCallback callback, Object state)\n\t   at System.Threading.ExecutionContext.Run(ExecutionContext executionContext, ContextCallback callback, Object state)\n\t   at System.Windows.Threading.DispatcherOperation.Invoke()\n\t   at System.Windows.Threading.Dispatcher.ProcessQueue()\n\t   at System.Windows.Threading.Dispatcher.WndProcHook(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean& handled)\n\t   at MS.Win32.HwndWrapper.WndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam, Boolean& handled)\n\t   at MS.Win32.HwndSubclass.DispatcherCallbackOperation(Object o)\n\t   at System.Windows.Threading.ExceptionWrapper.InternalRealCall(Delegate callback, Object args, Boolean isSingleParameter)\n\t   at System.Windows.Threading.ExceptionWrapper.TryCatchWhen(Object source, Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)\n\t   at System.Windows.Threading.Dispatcher.WrappedInvoke(Delegate callback, Object args, Boolean isSingleParameter, Delegate catchHandler)\n\t   at System.Windows.Threading.Dispatcher.InvokeImpl(DispatcherPriority priority, TimeSpan timeout, Delegate method, Object args, Boolean isSingleParameter)\n\t   at System.Windows.Threading.Dispatcher.Invoke(DispatcherPriority priority, Delegate method, Object arg)\n\t   at MS.Win32.HwndSubclass.SubclassWndProc(IntPtr hwnd, Int32 msg, IntPtr wParam, IntPtr lParam)\n\t   at MS.Win32.UnsafeNativeMethods.DispatchMessage(MSG& msg)\n\t   at System.Windows.Threading.Dispatcher.PushFrameImpl(DispatcherFrame frame)\n\t   at System.Windows.Threading.Dispatcher.PushFrame(DispatcherFrame frame)\n\t   at System.Windows.Threading.Dispatcher.Run()\n\t   at System.Windows.Application.RunDispatcher(Object ignore)\n\t   at System.Windows.Application.RunInternal(Window window)\n\t   at System.Windows.Application.Run(Window window)\n\t   at System.Windows.Application.Run()\n\t   at VCell2.App.Main() in C:\\Users\\wandrus\\Documents\\Visual Studio 2008\\Projects\\VCell2\\VCell2\\obj\\Debug\\App.g.cs:line 0\n\t\n\n**Edit** I've tried running it windbg (don't know if I'm doing this correctly)\n\n\tModLoad: 77310000 773b0000   C:\\Windows\\system32\\ADVAPI32.dll\n\tModLoad: 76a30000 76adc000   C:\\Windows\\system32\\msvcrt.dll\n\tModLoad: 76c60000 76c79000   C:\\Windows\\SYSTEM32\\sechost.dll\n\tModLoad: 76ae0000 76b82000   C:\\Windows\\system32\\RPCRT4.dll\n\tModLoad: 770c0000 77117000   C:\\Windows\\system32\\SHLWAPI.dll\n\tModLoad: 76940000 7698e000   C:\\Windows\\system32\\GDI32.dll\n\tModLoad: 76c80000 76d49000   C:\\Windows\\system32\\USER32.dll\n\tModLoad: 778e0000 778ea000   C:\\Windows\\system32\\LPK.dll\n\tModLoad: 77120000 771bd000   C:\\Windows\\system32\\USP10.dll\n\tModLoad: 76ea0000 76ebf000   C:\\Windows\\system32\\IMM32.DLL\n\tModLoad: 76b90000 76c5c000   C:\\Windows\\system32\\MSCTF.dll\n\tModLoad: 6c1b0000 6c1b5000   C:\\Windows\\system32\\avgrsstx.dll\n\tModLoad: 57310000 578a1000   C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\mscorwks.dll\n\tModLoad: 756a0000 7573b000   C:\\Windows\\WinSxS\\x86_microsoft.vc80.crt_1fc8b3b9a1e18e3b_8.0.50727.4918_none_d089094c442eb5ff\\MSVCR80.dll\n\tModLoad: 75c40000 76886000   C:\\Windows\\system32\\shell32.dll\n\tModLoad: 773c0000 7751b000   C:\\Windows\\system32\\ole32.dll\n\tModLoad: 75810000 7581b000   C:\\Windows\\system32\\profapi.dll\n\tModLoad: 53de0000 548d8000   C:\\Windows\\assembly\\NativeImages_v2.0.50727_32\\mscorlib\\70603943245265de9397091048337dda\\mscorlib.ni.dll\n\tModLoad: 757a0000 757ac000   C:\\Windows\\system32\\CRYPTBASE.dll\n\tModLoad: 744f0000 74530000   C:\\Windows\\system32\\uxtheme.dll\n\tModLoad: 52ea0000 53639000   C:\\Windows\\assembly\\NativeImages_v2.0.50727_32\\System\\ade9214f5bce88462742bce1278864c0\\System.ni.dll\n\tModLoad: 57ae0000 57e0c000   C:\\Windows\\assembly\\NativeImages_v2.0.50727_32\\WindowsBase\\c7663f3a74fb6aa480c60108634d285a\\WindowsBase.ni.dll\n\tModLoad: 03eb0000 04a5b000   C:\\Windows\\assembly\\NativeImages_v2.0.50727_32\\PresentationCore\\c79b7f336e6099b8c94081f975e9411e\\PresentationCore.ni.dll\n\tModLoad: 55240000 55fec000   C:\\Windows\\assembly\\NativeImages_v2.0.50727_32\\PresentationFramewo#\\7d80b7d912fbf0f7532f1b9adc235646\\PresentationFramework.ni.dll\n\tModLoad: 00e50000 01255000   PresentationCore.dll\n\tModLoad: 00e50000 01255000   PresentationCore.dll\n\tModLoad: 539d0000 53b7c000   C:\\Windows\\Microsoft.NET\\Framework\\v3.0\\WPF\\wpfgfx_v0300.dll\n\tModLoad: 76990000 76a1f000   C:\\Windows\\system32\\OLEAUT32.dll\n\tModLoad: 51520000 51754000   C:\\Windows\\assembly\\NativeImages_v2.0.50727_32\\System.Core\\e78709bedd31f237055667ad99b9451f\\System.Core.ni.dll\n\tModLoad: 6cbc0000 6cc1b000   C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\mscorjit.dll\n\tModLoad: 637d0000 638c1000   C:\\Windows\\assembly\\NativeImages_v2.0.50727_32\\System.Configuration\\9c2727d244dcc72fbefcf1ae22660f35\\System.Configuration.ni.dll\n\tModLoad: 57f20000 58456000   C:\\Windows\\assembly\\NativeImages_v2.0.50727_32\\System.Xml\\93d38ea87365928456313035f8091126\\System.Xml.ni.dll\n\tModLoad: 74130000 74143000   C:\\Windows\\system32\\dwmapi.dll\n\tModLoad: 60340000 60348000   C:\\Windows\\Microsoft.NET\\Framework\\v2.0.50727\\culture.dll\n\t(1e2c.738): C++ EH exception - code e06d7363 (first chance)\n\t(1e2c.738): C++ EH exception - code e06d7363 (first chance)\n\t(1e2c.738): C++ EH exception - code e06d7363 (first chance)\n\t(1e2c.738): C++ EH exception - code e06d7363 (first chance)\n\t(1e2c.738): C++ EH exception - code e06d7363 (first chance)\n\t(1e2c.738): C++ EH exception - code e06d7363 (first chance)\n\t(1e2c.738): C++ EH exception - code e06d7363 (first chance)\n\t(1e2c.738): CLR exception - code e0434f4d (first chance)\n\t(1e2c.738): C++ EH exception - code e06d7363 (first chance)\n\t(1e2c.738): CLR exception - code e0434f4d (first chance)\n\t(1e2c.738): CLR exception - code e0434f4d (first chance)\n\t(1e2c.738): CLR exception - code e0434f4d (first chance)\n\t(1e2c.738): CLR exception - code e0434f4d (!!! second chance !!!)\n\teax=0025e034 ebx=e0434f4d ecx=00000001 edx=00000000 esi=0025e0bc edi=002d66d8\n\teip=75acb4f4 esp=0025e034 ebp=0025e084 iopl=0         nv up ei pl nz ac po nc\n\tcs=001b  ss=0023  ds=0023  es=0023  fs=003b  gs=0000             efl=00000212\n\t*** ERROR: Symbol file could not be found.  Defaulted to export symbols for C:\\Windows\\system32\\KERNELBASE.dll - \n\tKERNELBASE!RaiseException+0x54:\n\t75acb4f4 c9              leave\n\t",
  "lastActivityDate": "2014-01-17T17:34:43.937",
  "title": "Why \"Optimize Code\" is needed to be turned on for my program to run without crashing?",
  "tags": [
    "wpf",
    "crash",
    "release-mode",
    "debug-mode",
    "optimize-code"
  ],
  "docScore": 0,
  "comments": [],
  "answers": [],
  "creationYearMonth": "201401",
  "itemTally": 0,
  "owner": null
}