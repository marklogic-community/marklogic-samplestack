{
  "id": "/questions/2071930",
  "creationDate": "2014-01-18T05:52:15.950",
  "body": "\n\nI have a class of library code which uses a System.Windows.Forms.WebBrowser control to load a web page then extract information from the DOM tree, etc... I've found this to be the only reliable way to be able to parse information loaded onto a page with javascript, etc...\n\nThis worked fine when testing with console app, but when I call the same method from an asp.net page (ASP.NET MVC Controller) it crashes with a \"ActiveX control '8856f961-340a-11d0-a96b-00c04fd705a2' cannot be instantiated because the current thread is not in a single-threaded apartment.\"... i've tried adding [STAThread] to my method but that doesn't seem to help!\n\nAny ideas?\n\nThanks\n\nUpdate:\n\nI need to allow a page to complete load and execute all its javascript, then search it for text that matches a template I have already stored... Don't think HtmlAgilityPack will work?  Does WatIn run the javascript?",
  "lastActivityDate": "2014-01-22T04:06:08.460",
  "title": "c# asp.net use Windows Forms WebBrowser",
  "tags": [
    "c#",
    "asp.net",
    "winforms"
  ],
  "docScore": 0,
  "comments": [],
  "answers": [],
  "creationYearMonth": "201401",
  "itemTally": 0,
  "owner": null
}