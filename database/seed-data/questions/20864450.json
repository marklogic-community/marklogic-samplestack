{"id":"/questions/20864450.json", "creationDate":"2014-01-01T00:10:14.867", "body":"\n\nI need to generate a null value in json if a result is not present in the rows returned from mysql. By 'not present', I mean there is no result for one or more values in $comps array. \n\n\t$data = array(\n\t    'rows' => array()\n\t);\n\t\n\t// these values will change, based on submitted form\n\t$comps = array( 'activity','purchase','groups'); \n\t\n\t$comps_count = count( $comps ); \n\t\n\t// mimic return from mysql\n\t$sql_results = array (\n\tarray ( 'year' => '2013', 'month' =>  '12', 'day' => '7', 'component' => 'activity', 'num' => '10'), \n\t\n\tarray ('year' => '2013', 'month' => '12', 'day' => '13', 'component' => 'purchase', 'num' => '11'), \n\tarray ('year' => '2013', 'month' => '12', 'day' => '13', 'component' => 'groups', 'num' => '12'), \n\t\n\tarray ('year' => '2013', 'month' => '12', 'day' => '30', 'component' => 'activity', 'num' => '13'), \n\tarray ('year' => '2013', 'month' => '12', 'day' => '30', 'component' => 'groups', 'num' => '14'),\n\t\n\tarray ('year' => '2013', 'month' => '12', 'day' => '31', 'component' => 'dummy', 'num' => '0'), \n\t);\n\t\n\t$results = array();\n\t\n\t\n\tforeach ( $sql_results as $row ) {\n\t\n\t    $results[] = (object)$row;\n\t\n\t}\n\t\n\t$j = 0; \n\t\n\tforeach ( $results as $result ) {\n\t\n\t    $num = (int) $result->num;\n\t\n\t    $year = (int) $result->year;\n\t    $month = (int) $result->month - 1;  // for javascript months\n\t    $day = (int) $result->day;\n\t\n\t    $this_date = $year . $month . $day;\n\t\n\t    $component = $result->component; \n\t    $key = array_search($component, $comps);\n\t\n\t    if ( $temp_date != $this_date ) {\n\t\n\t        if ( !empty( $temp_arr ) ) {\n\t\n\t            $diff = abs( ( $comps_count + 1 ) - count( $temp_arr ) );\n\t\n\t            if ( $diff != 0 ) {\n\t                for ( $i=0; $i<$diff; $i++ )\n\t                    $temp_arr[] = array('v' => null);\n\t            }\n\t\n\t            $data['rows'][] = array('c' => $temp_arr);\n\t\n\t            $temp_arr = array();\n\t            $j = 0;\n\t        }\n\t\n\t        $temp_arr[] = array('v' => \"Date($year, $month, $day)\");\n\t\n\t        $j++; \n\t\n\t        for ( $i=0; $i<$key; $i++ ) {\n\t\n\t            $temp_arr[] = array('v' => null);\n\t        }\n\t\n\t        $temp_arr[] = array('v' => $num);\n\t\n\t    }\n\t    else {\n\t        $j++; \n\t\n\t        $xcount = $comps_count - $key;\n\t\n\t        if ( $xcount != $j ) { \n\t            for ( $i=$xcount; $i<$key; $i++ ) {\n\t\n\t                $temp_arr[] = array('v' => null);\n\t            }   \n\t        }\n\t\n\t        $temp_arr[] = array('v' => $num);\n\t\n\t    }\n\t\n\t    $temp_date = $this_date;\n\t}\n\t\n\t$data['rows'][] = array('c' => $temp_arr);\n\t\n\t$json = json_encode($data, JSON_NUMERIC_CHECK);\n\t\n\techo $json;\n\t\n\nThe json output:\n\n\t{\"rows\":[\n\t{\"c\":[{\"v\":\"Date(2013, 11, 7)\"},{\"v\":10},{\"v\":null},{\"v\":null}]},\n\t{\"c\":[{\"v\":\"Date(2013, 11, 13)\"},{\"v\":null},{\"v\":11},{\"v\":null},{\"v\":12},{\"v\":null}]},\n\t{\"c\":[{\"v\":\"Date(2013, 11, 30)\"},{\"v\":13},{\"v\":null},{\"v\":14}]},\n\t{\"c\":[{\"v\":\"Date(2013, 11, 31)\"},{\"v\":0}]}\n\t]}\n\t\n\n(I'm not worried about the last dummy row ). \nThe problem is in the second json row. It should be:\n\n\t{\"c\":[{\"v\":\"Date(2013, 11, 13)\"},{\"v\":null},{\"v\":11},{\"v\":12}]},\n\t\n\nHow can I avoid inserting those extra nulls? \n\nAnd - there has to be an easier way to solve this, but I'm in brain-lock at the moment. ", "lastActivityDate":"2014-01-03T17:27:31.330", "title":"generating json for google charts - adding nulls", "tags":["php", "json"], "docScore":0, "comments":[], "answers":[], "creationYearMonth":"201401", "itemTally":0, "owner":null}