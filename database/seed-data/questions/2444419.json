{
  "id": "/questions/2444419",
  "creationDate": "2014-03-17T08:23:58.077",
  "body": "\n\nSo on my site, a user can post a comment on 2 things: a user's profile and an app. The code works fine in PHP but we decided to add Ajax to make it more stylish. The comment just fades into the page and works fine.\n\nI decided I wanted to make a function so that I wouldn't have to manage 2 (or more) blocks of codes in different files. Right now, the code is as follows for the two pages (not in a separate .js file, they're written inside the head tags for the pages.):\n\n\t// App page\n\t$(\"input#comment_submit\").click(function() {\n\tvar comment = $(\"#comment_box\").val();\n\t$.ajax({\n\ttype: \"POST\",\n\turl: \"app.php?id=<?php echo $id; ?>\",\n\tdata: {comment: comment},\n\tsuccess: function() {\n\t$(\"input#comment_submit\").attr(\"disabled\", \"disabled\").val(\"Comment Submitted!\");\n\t$(\"textarea#comment_box\").attr(\"disabled\", \"disabled\")\n\t$(\"#comments\").prepend(\"<div class=\\\"comment new\\\"></div>\");\n\t$(\".new\").prepend(\"<a href=\\\"profile.php?username=<?php echo $_SESSION['username']; ?>\\\" class=\\\"commentname\\\"><?php echo $_SESSION['username']; ?></a><p class=\\\"commentdate\\\"><?php echo date(\"M. d, Y\", time()) ?> - <?php echo date(\"g:i A\", time()); ?></p><p class=\\\"commentpost\\\">\" + comment + \"</p>\").hide().fadeIn(1000);\n\t}\n\t});\n\treturn false;\n\t});\n\t\n\nAnd next up,\n\n\t// Profile page\n\t$(\"input#comment_submit\").click(function() {\n\tvar comment = $(\"#comment_box\").val();\n\t$.ajax({\n\ttype: \"POST\",\n\turl: \"profile.php?username=<?php echo $user; ?>\",\n\tdata: {comment: comment},\n\tsuccess: function() {\n\t$(\"input#comment_submit\").attr(\"disabled\", \"disabled\").val(\"Comment Submitted!\");\n\t$(\"textarea#comment_box\").attr(\"disabled\", \"disabled\")\n\t$(\"#comments\").prepend(\"<div class=\\\"comment new\\\"></div>\");\n\t$(\".new\").prepend(\"<a href=\\\"profile.php?username=<?php echo $_SESSION['username']; ?>\\\" class=\\\"commentname\\\"><?php echo $_SESSION['username']; ?></a><p class=\\\"commentdate\\\"><?php echo date(\"M. d, Y\", time()) ?> - <?php echo date(\"g:i A\", time()); ?></p><p class=\\\"commentpost\\\">\" + comment + \"</p>\").hide().fadeIn(1000);\n\t}\n\t});\n\treturn false;\n\t});\n\t\n\nNow, on each page the box names will always be the same (comment_box and comment_submit) so what do you guys think of this function (Note, the postComment is in the head tag on the page.):\n\n\t// On the page, (profile.php)\n\t$(function() {\n\t    $(\"input#comment_submit\").click(function() {\n\t        postComment(\"profile\", \"<?php echo $user ?>\", \"<?php echo $_SESSION['username']; ?>\", \"<?php echo date(\"M. d, Y\", time()) ?>\", \"<?php echo date(\"g:i A\", time()); ?>\");\n\t    });\n\t});\n\t\n\nWhich leads to this function (which is stored in a separate file called functions.js):\n\n\tfunction postComment(page, argvalue, username, date, time) {\n\t    if (page == \"app\") { var arg = \"id\"; }\n\t    if (page == \"profile\") { var arg = \"username\"; }\n\t    var comment = $(\"#comment_box\").val();\n\t\n\t    $.ajax({\n\t        type: \"POST\",\n\t        url: page + \".php?\" + arg + \"=\" + argvalue,\n\t        data: {comment: comment},\n\t        success: function() {\n\t            $(\"textarea#comment_box\").attr(\"disabled\", \"disabled\")\n\t            $(\"input#comment_submit\").attr(\"disabled\", \"disabled\").val(\"Comment Submitted!\");\n\t            $(\"#comments\").prepend(\"<div class=\\\"comment new\\\"></div>\");\n\t            $(\".new\").prepend(\"<a href=\\\"\" + page + \".php?\" + arg + \"=\" + username + \"\\\" class=\\\"commentname\\\">\" + username + \"</a><p class=\\\"commentdate\\\">\" + date + \" - \" + time + \"</p><p class=\\\"commentpost\\\">\" + nl2br(comment) + \"</p>\").hide().fadeIn(1000);\n\t        }\n\t    });\n\t    return false;\n\t}\n\t\n\nThat's what I came up with! So, some problems: When I hit the button the page refreshes. What fixed this was taking the return false from the function and putting it into the button click. Any way to keep it in the function and have the same effect?\n\n**But my real question is this:** Can any coders out there that are familiar to jQuery tell me techniques, coding practices, or ways to write my code more efficiently/elegantly? I've done a lot of work in PHP but I know that echoing the date may not be the most efficient way to get the date and time.\n\nSo any tips that can really help me streamline this function and also make me better with writing jQuery are very welcome!",
  "lastActivityDate": "2014-03-17T08:52:26.643",
  "title": "Advice on my jQuery Ajax Function",
  "tags": [
    "jquery",
    "ajax",
    "coding-style",
    "function",
    "jquery-ajax"
  ],
  "docScore": 0,
  "comments": [],
  "answers": [],
  "creationYearMonth": "201403",
  "itemTally": 0,
  "owner": null
}