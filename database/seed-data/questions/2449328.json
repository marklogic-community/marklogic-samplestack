{
  "id": "/questions/2449328",
  "creationDate": "2014-03-18T02:01:51.133",
  "body": "\n\nI have been given a staff list which is supposed to be up to date but it doesn't match an intranet People Finder which is written in ASP.NET.\n\nAs the information is sensitive I am not able to access the database the People Finder is using so the only way I can get at the information is by scraping the structure starting at the top brass at the top and then going through each tier in turn.\n\nEach person has a Staff number which then forms the URL `http://intranet/peoplefinder/index.aspx?srn=ABC1234` and then all the people who report to them are listed underneth in the format `<a id=\"gvEmployees_ctl03_lnkFullName\" href=\"index.aspx?srn=ABC4321\" target=\"_self\">` where each URL indicates the Staff number and provides a link to their team.\n\nThe trouble arises when the teams are big as paging is implemented in the GridView with an URL such as `<a href=\"javascript:__doPostBack('gvEmployees','Page$2')\">2</a>`.\n\nHow would I scrape this page, capture the SRN and other details along with the people who report to the person on all pages of the GridView then loop through each reportee and do the same process until the whole list is complete?\n\n**Example HTML of result**\n\n\t<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\">\n\t\n\t<html xmlns=\"http://www.w3.org/1999/xhtml\" >\n\t<head><title>\n\t    People Finder: Name Surname\n\t</title><link rel=\"stylesheet\" href=\"/path/to/style.css\" type=\"text/css\" /><link rel=\"stylesheet\" href=\"/path/to/anotherStyle.css\" type=\"text/css\" />\n\t    <script type=\"text/javascript\" src=\"/path/to/peoplefinder.js\"></script>\n\t</head>\n\t<body>\n\t    <form name=\"form1\" method=\"post\" action=\"/path/to/index.aspx\" id=\"form1\">\n\t<div>\n\t<input type=\"hidden\" name=\"__EVENTTARGET\" id=\"__EVENTTARGET\" value=\"\" />\n\t<input type=\"hidden\" name=\"__EVENTARGUMENT\" id=\"__EVENTARGUMENT\" value=\"\" />\n\t<input type=\"hidden\" name=\"__VIEWSTATE\" id=\"__VIEWSTATE\" value=\"### ViewState ###\" />\n\t</div>\n\t\n\t<script type=\"text/javascript\">\n\t<!--\n\tvar theForm = document.forms['form1'];\n\tif (!theForm) {\n\t    theForm = document.form1;\n\t}\n\tfunction __doPostBack(eventTarget, eventArgument) {\n\t    if (!theForm.onsubmit || (theForm.onsubmit() != false)) {\n\t        theForm.__EVENTTARGET.value = eventTarget;\n\t        theForm.__EVENTARGUMENT.value = eventArgument;\n\t        theForm.submit();\n\t    }\n\t}\n\t// -->\n\t</script>\n\t\n\t\n\t<script src=\"/path/to/WebResource.axd?d=AueXWrgAf8xSxMTAt1Q4AA2&amp;t=633311832634916698\" type=\"text/javascript\"></script>\n\t\n\t        <div class=\"HP3CHeader\">\n\t            <div id=\"LWHPBanner\">\n\t                <h1><span id=\"lblName\">Name Surname</span></h1>\n\t            </div>\n\t        </div>\n\t\n\t        <div id='CPMain'>\n\t            <div id=\"mainBox\">\n\t\n\t            <div id=\"pnlEmployeeDetails\">\n\t\n\t                <div id='basicData'>\n\t                    <img id=\"imgPhoto\" class=\"photo\" src=\"/path/to/photo.jpg\" style=\"height:69px;width:69px;border-width:0px;\" />\n\t                    <span id=\"lblBusinessUnit\">Business Unit</span>\n\t                    <span id=\"lblCostCentreName\">Cost Centre</span>\n\t                    <span id=\"lblLocation\">Location</span>\n\t\n\t                    <a href='/path/to/checkcontactdetails.htm' target='_blank' onclick='return OpenCheckContactDetails();' >Find out how to change your details/photo.</a>\n\t                    <div id=\"manager\">\n\t        <strong>Reports to: </strong><a id=\"hlManager\" href=\"/path/to/index.aspx?srn=ABC1234\">Name Surname</a>\n\t    </div>\n\t                </div>\n\t\n\t                <div id='contactData'>\n\t\n\t                    <div id=\"pnlSrn\">\n\t        <strong>Staff number:</strong> <span id=\"lblSrn\">ABC1234</span>\n\t    </div>\n\t\n\t\n\t                    <div id=\"pnlEmailAddress\">\n\t        <strong>Email Address:</strong> <span id=\"lblEmailAddress\">Email</span>\n\t    </div>\n\t                    <div style=\"clear: both\"></div>\n\t                </div>\n\t\n\t</div>\n\t\n\t            <div id=\"pnlGrid\">\n\t\n\t                <h3><span id=\"lblGridTitle\">Name's team</span></h3>\n\t            <div>\n\t        <table class=\"subordinates\" cellspacing=\"0\" cellpadding=\"2\" rules=\"cols\" border=\"1\" id=\"gvEmployees\" style=\"border-style:None;border-collapse:collapse;\">\n\t            <tr style=\"color:Black;background-color:#EFF3FB;border-style:None;font-weight:bold;\">\n\t                <th scope=\"col\"><a href=\"javascript:__doPostBack('gvEmployees','Sort$SRN')\" style=\"color:Black;\">SRN</a></th><th scope=\"col\"><a href=\"javascript:__doPostBack('gvEmployees','Sort$FullName')\" style=\"color:Black;\">Full name</a></th><th scope=\"col\"><a href=\"javascript:__doPostBack('gvEmployees','Sort$RACFID')\" style=\"color:Black;\">RACFID</a></th>\n\t            </tr><tr class=\"reports\" style=\"background-color:White;border-style:None;\">\n\t                <td style=\"width:70px;\">ABC1234</td><td>\n\t                            <a id=\"gvEmployees_ctl02_lnkFullName\" href=\"index.aspx?srn=1K5932\" target=\"_self\">Name Surname</a> \n\t                        </td><td>ABCD</td>\n\t            </tr><tr class=\"reports\" style=\"background-color:#EFF3FB;border-style:None;\">\n\t                <td style=\"width:70px;\">ABC1234</td><td>\n\t                            <a id=\"gvEmployees_ctl03_lnkFullName\" href=\"/path/to/index.aspx?srn=ABC1234\" target=\"_self\">Name Surname</a> \n\t                        </td><td>ABCD</td>\n\t            </tr><tr class=\"reports\" style=\"background-color:White;border-style:None;\">\n\t                <td style=\"width:70px;\">ABC1234</td><td>\n\t                            <a id=\"gvEmployees_ctl04_lnkFullName\" href=\"/path/to/index.aspx?srn=ABC1234\" target=\"_self\">Name Surname</a> \n\t                        </td><td>ABCD</td>\n\t            </tr><tr class=\"reports\" style=\"background-color:#EFF3FB;border-style:None;\">\n\t                <td style=\"width:70px;\">ABC1234</td><td>\n\t                            <a id=\"gvEmployees_ctl05_lnkFullName\" href=\"/path/to/index.aspx?srn=ABC1234\" target=\"_self\">Name Surname</a> \n\t                        </td><td>ABCD</td>\n\t            </tr><tr class=\"reports\" style=\"background-color:White;border-style:None;\">\n\t                <td style=\"width:70px;\">ABC1234</td><td>\n\t                            <a id=\"gvEmployees_ctl06_lnkFullName\" href=\"/path/to/index.aspx?srn=ABC1234\" target=\"_self\">Name Surname</a> \n\t                        </td><td>ABCD</td>\n\t            </tr><tr class=\"reports\" style=\"background-color:#EFF3FB;border-style:None;\">\n\t                <td style=\"width:70px;\">ABC1234</td><td>\n\t                            <a id=\"gvEmployees_ctl07_lnkFullName\" href=\"/path/to/index.aspx?srn=ABC1234\" target=\"_self\">Name Surname</a> \n\t                        </td><td>ABCD</td>\n\t            </tr><tr class=\"reports\" style=\"background-color:White;border-style:None;\">\n\t                <td style=\"width:70px;\">ABC1234</td><td>\n\t                            <a id=\"gvEmployees_ctl08_lnkFullName\" href=\"/path/to/index.aspx?srn=ABC1234\" target=\"_self\">Name Surname</a> \n\t                        </td><td>ABCD</td>\n\t            </tr><tr class=\"reports\" style=\"background-color:#EFF3FB;border-style:None;\">\n\t                <td style=\"width:70px;\">ABC1234</td><td>\n\t                            <a id=\"gvEmployees_ctl09_lnkFullName\" href=\"/path/to/index.aspx?srn=ABC1234\" target=\"_self\">Name Surname</a> \n\t                        </td><td>ABCD</td>\n\t            </tr><tr class=\"reports\" style=\"background-color:White;border-style:None;\">\n\t                <td style=\"width:70px;\">ABC1234</td><td>\n\t                            <a id=\"gvEmployees_ctl10_lnkFullName\" href=\"/path/to/index.aspx?srn=ABC1234\" target=\"_self\">Name Surname</a> \n\t                        </td><td>ABCD</td>\n\t            </tr><tr class=\"reports\" style=\"background-color:#EFF3FB;border-style:None;\">\n\t                <td style=\"width:70px;\">ABC1234</td><td>\n\t                            <a id=\"gvEmployees_ctl11_lnkFullName\" href=\"/path/to/index.aspx?srn=ABC1234\" target=\"_self\">Name Surname</a> \n\t                        </td><td>ABCD</td>\n\t            </tr><tr class=\"PagerStyle\" style=\"color:#000039;border-style:None;\">\n\t                <td colspan=\"3\"><table border=\"0\">\n\t                    <tr>\n\t                        <td><span>1</span></td><td><a href=\"javascript:__doPostBack('gvEmployees','Page$2')\" style=\"color:#000039;\">2</a></td>\n\t                    </tr>\n\t                </table></td>\n\t            </tr>\n\t        </table>\n\t    </div>\n\t\n\t</div>\n\t            </div>\n\t\n\t            <div id=\"searchBox\">\n\t                <strong>Search People Finder:</strong>\n\t                <br /><br />\n\t                <span>Forename:</span><br/>\n\t                <span><input name=\"txtFirstname\" type=\"text\" id=\"txtFirstname\" /></span><br/>\n\t                <span>Surname:</span><br/>\n\t                <span><input name=\"txtSurname\" type=\"text\" id=\"txtSurname\" /></span><br/>\n\t                <span>RACFID:</span><br/>\n\t                <span><input name=\"txtRacfid\" type=\"text\" id=\"txtRacfid\" /></span><br/>\n\t                <span>Staff number:</span><br/>\n\t                <span><input name=\"txtSrn\" type=\"text\" id=\"txtSrn\" /></span><br/>\n\t                <div class=\"searchBoxItem\" style=\"text-align:center;width:100%\"><input type=\"submit\" name=\"btnFind\" value=\"Search\" onclick=\"javascript:WebForm_DoPostBackWithOptions(new WebForm_PostBackOptions(&quot;btnFind&quot;, &quot;&quot;, false, &quot;&quot;, &quot;index.aspx&quot;, false, false))\" id=\"btnFind\" title=\"Search for employees member\" class=\"button\" style=\"border-style:Outset;\" /></div><br/> \n\t                <div>People Finder searches only UK staff.</div> \n\t               <!-- <div><a class=\"execBoardLink\" href=\"/path/to/index.aspx?srn=ABC1234\">Show Executive Board</a></div> -->\n\t                <div style=\"margin-top:5px;\"><a href=\"/path/to/phonebook\" target=\"phoneBook\" onclick='return OpenPhonebook();' title=\"Open Phonebook in new window\">Open Phonebook</a></div>\n\t            </div>\n\t        </div>\n\t\n\t        <div class=\"contentFooter\"  style=\"text-align:center;\">\n\t            <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" border=\"0\" summary=\"Navigation layout table\">\n\t                <tr>\n\t                    <td align=\"left\"><span class=\"linkArrow\">&lt;</span> <a href=\"javascript:history.back();\">Back</a></td>\n\t                    <td align=\"center\"></td>\n\t                    <td align=\"right\"><span class=\"linkArrow\">^ </span><a href=\"#top\">Top</a></td>\n\t                </tr>\n\t            </table>\n\t        </div> \n\t\n\t<div>\n\t\n\t    <input type=\"hidden\" name=\"__PREVIOUSPAGE\" id=\"__PREVIOUSPAGE\" value=\"vy066Txz34y1E515UsTSTDabHKEmdBRCsq7xM0lpJls1\" />\n\t    <input type=\"hidden\" name=\"__EVENTVALIDATION\" id=\"__EVENTVALIDATION\" value=\"/wEWCgKM3uTTAgLP/83pDwLfwaTTAQKNguzjCAKt98LeCwLZh62pDwKKqdGpBwLd2q7jAwKa+5aMBAL5zb65C42zY4GBEUKujhjtZ/hZ8sLESfiF\" />\n\t</div></form>\n\t</body>\n\t</html>\n\t",
  "lastActivityDate": "2014-03-19T21:12:04.523",
  "title": "How do I scrape information off ASP.NET websites when paging and JavaScript links are being used?",
  "tags": [
    "c#",
    "asp.net",
    "vb.net",
    "gridview",
    "scrape"
  ],
  "docScore": 0,
  "comments": [],
  "answers": [],
  "creationYearMonth": "201403",
  "itemTally": 0,
  "owner": null
}