{
  "id": "/questions/2265415",
  "creationDate": "2014-02-18T03:00:13.030",
  "body": "\n\nHello there I have a database that has 2 tables in it, one is the categoryTable and the is the userMenuTable,  the categoryTable currently has two columns in it, **categoryId** and **categoryTitle**\nit currently holds 2 rows of data, the categoryId's = **1** and **2** and the categoryTitles = **News** and **Blog**, in the the **userMenuTable** I keep a record of what categories that user has selected, the table has 3 columns, **menuEntryId**, **categoryId** and **cookieId**, this table keeps a record of which cookie has which category selected, the ID is to then run these queries, \n\nThe first query, gets the users selected categories\n\n\tfunction getMenu($cookieId) {\n\t  $this->db->select('*');\n\t  $this->db->from('categoryTable');\n\t  $this->db->join('userMenuTable', 'categoryTable.categoryId = userMenuTable.categoryId', 'left');\n\t  $this->db->where('userMenuTable.cookieId', $cookieId);\n\t\n\t  $query = $this->db->get();\n\t  return $query->result_array();\n\t\n\t }\n\t\n\nThe next query gets all the categories that have no cookieId assigned to them, \n\n\tfunction getAllMenus($cookieId) {\n\t$sql =\"SELECT categoryTable.categoryTitle, categoryTable.categoryId, userMenuTable.cookieId, userMenuTable.menuEntryId, categoryTable.categoryOnline,\n\tcategoryTable.categoryIsSpecial, categoryTable.categoryDateCreated, categoryTable.categorySlug, categoryTable.dashboardUserId, categoryTable.categoryAbstract\n\tFROM categoryTable LEFT JOIN userMenuTable\n\t   ON categoryTable.categoryId = userMenuTable.categoryId\n\t UNION ALL \n\t SELECT categoryTable.categoryTitle, categoryTable.categoryId, userMenuTable.cookieId, userMenuTable.menuEntryId, categoryTable.categoryOnline,\n\tcategoryTable.categoryIsSpecial, categoryTable.categoryDateCreated, categoryTable.categorySlug, categoryTable.dashboardUserId, categoryTable.categoryAbstract FROM categoryTable RIGHT JOIN userMenuTable\n\t   ON categoryTable.categoryId = userMenuTable.categoryId\n\t WHERE userMenuTable.cookieId = NULL\";\n\t\n\n$query = $this->db->query($sql);\n   return $query->result_array();\n   }\n\nhowever this returns an array that looks like this, \n\n\t[0] => Array\n\t    (\n\t        [categoryId] => 1\n\t        [categoryTitle] => blog\n\t        [categoryAbstract] => <p>asdsdsadasdsadfdsgdgdsgdsgssssssssssss</p>\n\t        [categorySlug] => blog\n\t        [categoryIsSpecial] => 0\n\t        [categoryOnline] => 1\n\t        [categoryDateCreated] => 1265123745\n\t        [dashboardUserId] => 0\n\t        [menuEntryId] => 5\n\t        [cookieId] => bang4b696152b4869\n\t    )\n\t\n\t[1] => Array\n\t    (\n\t        [categoryId] => 8\n\t        [categoryTitle] => News\n\t        [categoryAbstract] => <p>The world at Bang Marketing moves fast, keep up to date w\n\t        [categorySlug] => news\n\t        [categoryIsSpecial] => 0\n\t        [categoryOnline] => 1\n\t        [categoryDateCreated] => 1265283717\n\t        [dashboardUserId] => 0\n\t        [menuEntryId] => 6\n\t        [cookieId] => bang4b696152b4869\n\t    )\n\t\n\t[2] => Array\n\t    (\n\t        [categoryTitle] => blog\n\t        [categoryId] => 1\n\t        [cookieId] => bang4b696152b4869\n\t        [menuEntryId] => 5\n\t        [categoryOnline] => 1\n\t        [categoryIsSpecial] => 0\n\t        [categoryDateCreated] => 1265123745\n\t        [categorySlug] => blog\n\t        [dashboardUserId] => 0\n\t        [categoryAbstract] => <p>asdsdsadasdsadfdsgdgdsgdsgssssssssssss</p>\n\t    )\n\t\n\t[3] => Array\n\t    (\n\t        [categoryTitle] => News\n\t        [categoryId] => 8\n\t        [cookieId] => bang4b696152b4869\n\t        [menuEntryId] => 6\n\t        [categoryOnline] => 1\n\t        [categoryIsSpecial] => 0\n\t        [categoryDateCreated] => 1265283717\n\t        [categorySlug] => news\n\t        [dashboardUserId] => 0\n\t        [categoryAbstract] => <p>The world at Bang Marketing moves fast, keep up to date w\n\t    )\n\t)\n\t\n\nSomehow I need to build a query that returns all the categories that are in the **categoryTable** and checks that against there it's Id matches one that is in the **userMenuTable** where the **cookieId** matches that of the users, and then return an array so I can loop through it like this, \n\n\t if(isset($mainMenu)) {\n\t   //die(print_r($mainMenu));\n\t   foreach ($mainMenu as $k => $v) {\n\t    if($v['menuEntryId'] == '') {\n\t     echo \"<li class='menuItem'>\n\t     <a href='\".base_url().\"welcome/getContent/$v[categoryId]' class='navLink' id='$v[categoryTitle]'>\".$v['categoryTitle'].\"</a>\n\t     </li>\";\n\t    } else {\n\t     echo \"<li class='menuItem'>\n\t     <a href='\".base_url().\"welcome/getContent/$v[categoryId]' class='saved navLink' id='$v[categoryTitle]'>\".$v['categoryTitle'].\"</a>\n\t     </li>\";\n\t    }\n\t   }\n\t  } else {\n\t   // do something else\n\t   //echo \"here\";\n\t  }\n\t",
  "lastActivityDate": "2014-02-18T07:18:54.663",
  "title": "PHP and mySQL help",
  "tags": [
    "php",
    "database",
    "codeigniter",
    "mysql"
  ],
  "docScore": 0,
  "comments": [],
  "answers": [],
  "creationYearMonth": "201402",
  "itemTally": 0,
  "owner": null
}